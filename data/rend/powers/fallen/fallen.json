{
  "type": "origins:multiple",
  "summoner": {
    "type": "origins:entity_set"
  },
  "enemies": {
    "type": "origins:entity_set"
  },
  "chance_for_armour": {
    "type": "origins:action_on_callback",
    "entity_action_gained": {
      "type": "origins:and",
      "actions": [
        {
          "type": "origins:chance",
          "chance": 0.4,
          "success_action": {
            "type": "origins:execute_command",
            "command": "execute unless items entity @s armor.head * run item replace entity @s armor.head with minecraft:chainmail_helmet 1"
          }
        },
        {
          "type": "origins:chance",
          "chance": 0.4,
          "success_action": {
            "type": "origins:execute_command",
            "command": "execute unless items entity @s armor.chest * run item replace entity @s armor.chest with minecraft:chainmail_chestplate 1"
          }
        },
        {
          "type": "origins:chance",
          "chance": 0.4,
          "success_action": {
            "type": "origins:execute_command",
            "command": "execute unless items entity @s armor.legs * run item replace entity @s armor.legs with minecraft:chainmail_leggings 1"
          }
        },
        {
          "type": "origins:chance",
          "chance": 0.4,
          "success_action": {
            "type": "origins:execute_command",
            "command": "execute unless items entity @s armor.feet * run item replace entity @s armor.feet with minecraft:chainmail_boots 1"
          }
        }
      ]
    }
  },
  "set_enemy_when_attacked": {
    "type": "origins:action_when_hit",
    "bientity_action": {
      "type": "origins:and",
      "actions": [
        {
          "type": "origins:actor_action",
          "action": {
            "type": "origins:execute_command",
            "command": "scoreboard players operation #rend_fallen_attacker rend_team = @s rend_team"
          }
        },
        {
          "type": "origins:if_else",
          "condition": {
            "type": "origins:target_condition",
            "condition": {
              "type": "origins:command",
              "command": "execute if score #rend_fallen_attacker rend_team = @s rend_team",
              "comparison": "==",
              "compare_to": 0
            }
          },
          "if_action": {
            "type": "origins:invert",
            "action": {
              "type": "origins:add_to_entity_set",
              "set": "*:fallen/fallen_enemies",
              "time_limit": 3000
            }
          }
        }
      ]
    },
    "cooldown": 20
  },
  "prevent_friendly_damage": {
    "type": "origins:modify_damage_taken",
    "attacker_action": {
      "type": "origins:execute_command",
      "command": "scoreboard players operation #rend_fallen_attacker rend_team = @s rend_team"
    },
    "bientity_condition": {
      "type": "origins:and",
      "conditions": [
        {
          "type": "origins:actor_condition",
          "condition": {
            "type": "origins:entity_type",
            "entity_type": "minecraft:player",
            "inverted": true
          }
        },
        {
          "type": "origins:actor_condition",
          "condition": {
            "type": "origins:command",
            "command": "execute if score #rend_fallen_attacker rend_team = @s rend_team",
            "comparison": "==",
            "compare_to": 1
          }
        }
      ]
    },
    "modifier": {
      "id": "rend:fallen/fallen_prevent_friendly_damage",
      "operation": "set_total",
      "amount": 0
    }
  },
  "weapon_switch": {
    "type": "origins:action_over_time",
    "entity_action": {
      "type": "origins:if_else",
      "condition": {
        "type": "origins:entity_in_radius",
        "radius": 16,
        "shape": "sphere",
        "bientity_condition": {
          "type": "origins:and",
          "conditions": [
            {
              "type": "origins:in_entity_set",
              "set": "*:fallen/fallen_enemies"
            },
            { "type": "origins:can_see" }
          ]
        },
        "comparison": ">",
        "compare_to": 0
      },
      "if_action": {
        "type": "origins:and",
        "actions": [
          {
            "type": "origins:if_else",
            "condition": {
              "type": "origins:entity_in_radius",
              "radius": 5,
              "shape": "sphere",
              "bientity_condition": {
                "type": "origins:and",
                "conditions": [
                  {
                    "type": "origins:in_entity_set",
                    "set": "*:fallen/fallen_enemies"
                  },
                  { "type": "origins:can_see" }
                ]
              },
              "comparison": ">",
              "compare_to": 0
            },
            "if_action": {
              "type": "origins:execute_command",
              "command": "scoreboard players set @s rend_fallen_use_bow 0"
            },
            "else_action": {
              "type": "origins:execute_command",
              "command": "scoreboard players set @s rend_fallen_use_bow 1"
            }
          },
          {
            "type": "origins:execute_command",
            "command": "function rend:fallen/can_attack"
          }
        ]
      },
      "else_action": {
        "type": "origins:execute_command",
        "command": "function rend:fallen/prevent_attack"
      }
    },
    "interval": 20
  }
}
